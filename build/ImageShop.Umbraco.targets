<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="CopyImageshopFiles" AfterTargets="Build">
    <PropertyGroup>
      <ImageshopSource>$(MSBuildThisFileDirectory)..\content\App_plugins\Imageshop</ImageshopSource>
      <ImageshopTarget>$(ProjectDir)App_Plugins\Imageshop</ImageshopTarget>
    </PropertyGroup>

    <ItemGroup>
      <_ImageshopFiles Include="$(ImageshopSource)\**\*.*" />
    </ItemGroup>

    <Message Text="Copying: %(_ImageshopFiles.Identity) â†’ $(ImageshopTarget)\%(RecursiveDir)%(Filename)%(Extension)" Importance="High" />

    <Copy
      SourceFiles="@(_ImageshopFiles)"
      DestinationFiles="@(_ImageshopFiles->'$(ImageshopTarget)\%(RecursiveDir)%(Filename)%(Extension)')"
      SkipUnchangedFiles="true" />
  </Target>
</Project>